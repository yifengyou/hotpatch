From 2343fef023a8cd64473161fa82a0d81cb5007cf9 Mon Sep 17 00:00:00 2001
From: Pavel Boldin <pboldin@cloudlinux.com>
Date: Tue, 30 Jan 2018 00:04:54 +0200
Subject: [PATCH 09/89] execve: abort() on failure

Signed-off-by: Pavel Boldin <pboldin@cloudlinux.com>
---
 tests/execve/execve.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/tests/execve/execve.c b/tests/execve/execve.c
index b3df0e4..eb3e9d3 100644
--- a/tests/execve/execve.c
+++ b/tests/execve/execve.c
@@ -81,7 +81,7 @@ notify_listener(void)
 	sock = socket(AF_UNIX, SOCK_STREAM | SOCK_CLOEXEC, 0);
 	if (sock == -1) {
 		dprintf("socket() error: %s(%d)\n", strerror(errno), errno);
-		return;
+		abort();
 	}
 	dprintf("socket()\n");
 
@@ -96,7 +96,7 @@ notify_listener(void)
 	if (rv == -1) {
 		fprintf(stderr, "libcare-execve: connect() error: %s(%d)\n", strerror(errno), errno);
 		(void) close(sock);
-		return;
+		abort();
 	}
 	dprintf("connect()\n");
 
@@ -113,7 +113,7 @@ notify_listener(void)
 	if (rv == -1) {
 		fprintf(stderr, "send() error: %s(%d)\n", strerror(errno), errno);
 		(void) close(sock);
-		return;
+		abort();
 	}
 	dprintf("send()\n");
 
@@ -123,6 +123,7 @@ notify_listener(void)
 
 	if (rv == -1) {
 		fprintf(stderr, "recv() error: %s(%d)\n", strerror(errno), errno);
+		abort();
 	}
 	dprintf("recv()\n");
 
-- 
2.23.0

